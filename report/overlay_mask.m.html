<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>~/Desktop/ug3_Vision/src/overlay_mask.m.html</title>
<meta name="Generator" content="Vim/7.2">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>
<body bgcolor="#ffffff" text="#808080"><font face="monospace">
<font color="#0000ff"><b>&nbsp;1 </b></font><span style="background-color: #ffffff"><font color="#808080"><b>% returns the result of putting |mask| onto |image|</b></font></span><br>
<font color="#0000ff"><b>&nbsp;2 </b></font><span style="background-color: #ffffff"><font color="#808080"><b>% for each pixel that is set in some channel of |mask|, saturates the pixel in</b></font></span><br>
<font color="#0000ff"><b>&nbsp;3 </b></font><span style="background-color: #ffffff"><font color="#808080"><b>% the equivalent channel of |image|</b></font></span><br>
<font color="#0000ff"><b>&nbsp;4 </b></font><font color="#000000">function</font>&nbsp;image = overlay_mask(image, mask, varargin)<br>
<font color="#0000ff"><b>&nbsp;5 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: #ffffff"><font color="#808080"><b>% parse options</b></font></span><br>
<font color="#0000ff"><b>&nbsp;6 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;argc = <font color="#0000ff">size</font>(varargin, <span style="background-color: #ffffff"><font color="#ff6060"><b>2</b></font></span>)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>&nbsp;7 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;c = <span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>&nbsp;8 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">while</font>&nbsp;c <font color="#0000ff">&lt;=</font>&nbsp;argc<br>
<font color="#0000ff"><b>&nbsp;9 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg = varargin{c}<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>10 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font>&nbsp;strcmpi(arg, <font color="#ff40ff"><b>'GrayScale'</b></font>)<br>
<font color="#0000ff"><b>11 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grayscale = <span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>12 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">elseif</font>&nbsp;strcmpi(arg, <font color="#ff40ff"><b>'Saturation'</b></font>)<br>
<font color="#0000ff"><b>13 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font>&nbsp;c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>&nbsp;<font color="#0000ff">&gt;</font>&nbsp;argc<br>
<font color="#0000ff"><b>14 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">error</font>(<font color="#ff40ff"><b>'Saturation option should be followed by a double'</b></font>)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>15 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>16 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saturation = varargin{c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>}<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>17 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>18 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">elseif</font>&nbsp;strcmpi(arg, <font color="#ff40ff"><b>'Lightness'</b></font>)<br>
<font color="#0000ff"><b>19 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font>&nbsp;c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>&nbsp;<font color="#0000ff">&gt;</font>&nbsp;argc<br>
<font color="#0000ff"><b>20 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">error</font>(<font color="#ff40ff"><b>'Lightness option should be followed by a double'</b></font>)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>21 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>22 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lightness = varargin{c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>}<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>23 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>24 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>25 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = c <font color="#0000ff">+</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>26 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>27 </b></font><br>
<font color="#0000ff"><b>28 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: #ffffff"><font color="#808080"><b>% modify background image</b></font></span><br>
<font color="#0000ff"><b>29 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font>&nbsp;exist(<font color="#ff40ff"><b>'grayscale'</b></font>, <font color="#ff40ff"><b>'var'</b></font>)<br>
<font color="#0000ff"><b>30 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gray_image = rgb2gray(image)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>31 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = cat(<span style="background-color: #ffffff"><font color="#ff6060"><b>3</b></font></span>, gray_image, gray_image, gray_image)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>32 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>33 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font>&nbsp;exist(<font color="#ff40ff"><b>'saturation'</b></font>, <font color="#ff40ff"><b>'var'</b></font>)<br>
<font color="#0000ff"><b>34 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hsv_image = rgb2hsv(image)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>35 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hsv_image(:,:,<span style="background-color: #ffffff"><font color="#ff6060"><b>2</b></font></span>) = hsv_image(:,:,<span style="background-color: #ffffff"><font color="#ff6060"><b>2</b></font></span>) <font color="#0000ff">*</font>&nbsp;saturation<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>36 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = hsv2rgb(hsv_image)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>37 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>38 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font>&nbsp;exist(<font color="#ff40ff"><b>'lightness'</b></font>, <font color="#ff40ff"><b>'var'</b></font>)<br>
<font color="#0000ff"><b>39 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hsv_image = rgb2hsv(image)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>40 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hsv_image(:,:,<span style="background-color: #ffffff"><font color="#ff6060"><b>3</b></font></span>) = hsv_image(:,:,<span style="background-color: #ffffff"><font color="#ff6060"><b>3</b></font></span>) <font color="#0000ff">*</font>&nbsp;lightness<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>41 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = hsv2rgb(hsv_image)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>42 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>43 </b></font><br>
<font color="#0000ff"><b>44 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: #ffffff"><font color="#808080"><b>% lay mask onto background image</b></font></span><br>
<font color="#0000ff"><b>45 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;num_channels = <font color="#0000ff">size</font>(image, <span style="background-color: #ffffff"><font color="#ff6060"><b>3</b></font></span>)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>46 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;channels = <span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>&nbsp;: num_channels<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>47 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">for</font>&nbsp;c = <span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>&nbsp;: num_channels<br>
<font color="#0000ff"><b>48 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel = image(:,:,c)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>49 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask_pixels = find(mask(:,:,c) <font color="#0000ff">==</font>&nbsp;<span style="background-color: #ffffff"><font color="#ff6060"><b>1</b></font></span>)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>50 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel(mask_pixels) = <span style="background-color: #ffffff"><font color="#ff6060"><b>255</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>51 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image(:,:,c) = channel<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>52 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">for</font>&nbsp;d = setdiff(channels, c)<br>
<font color="#0000ff"><b>53 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel = image(:,:,d)<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>54 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel(mask_pixels) = <span style="background-color: #ffffff"><font color="#ff6060"><b>0</b></font></span><span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>55 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image(:,:,d) = channel<span style="background-color: #ffffff"><font color="#808080"><b>;</b></font></span><br>
<font color="#0000ff"><b>56 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>57 </b></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">end</font><br>
<font color="#0000ff"><b>58 </b></font><font color="#0000ff">end</font><br>
</font></body>
</html>
